# 14장 일관성 있는 협력

## 스터디 날짜
2022/02/17

객체지향 패러다임의 장점은 설계를 재사용할 할 수 있다는 것이다.<br>
재사용을 위해서 객체들의 협력 방식을 일관성 있게 만들어야 한다.<br>
가능하면 유사한 기능을 구현하기 위해 유사한 협력 패턴을 사용하라.
## 1. 핸드폰 과금 시스템 변경하기
시간대별 방식, 요일별 방식를 구현하였다.<br>
시간대별 방식 : 구성 요소를 별도의 List 로 관리<br>
요일별 방식 : 별도의 클래스를 사용<br>

### 발생하는 문제점 : 개념적으로는 연관돼 있지만 구현 방식에 있어서는 완전 제각각이다.
유사한 문제를 해결하고 있음에도 불구하고 설계에 일관성이 없다.<br>
1. 새로운 정책을 추가하면 추가할수록 코드 사이의 일관성이 점점 어긋난다.
2. 코드를 이해하기 어려워진다.
**결론은 유사한 기능을 서로 다른 방식으로 구현해서는 안된다.**

## 2. 설계에 일관성 부여하기
- 변하는 개념을 변하지 않는 개념으로부터 분리하라
- 변하는 개념을 캡슐화하라

그렇다면 클래스를 분리하기 위해 어떤 기준을 따르는 것이 좋은가?<br>
기준은 변경의 이유와 주기이다.<br>
단일 책임 원칙을 따르도록 클래스를 분리해야 한다. - 단 하나의 이유에 의해서만 변경되어야 한다.<br>
<br>
- 변하는 개념을 변하지 않는 개념으로부터 분리하라
- 변하는 개념을 캡슐화하라

변하는 개념은 구체 클래스로 캡슐화 하고 변하지 않는 개념은 추상화로 추상화끼리만 의존하도록 만들어라.<br>
<br>

### 캡슐화
**캡슐화 : 변하는 어떤 것이든 감추는 것이다.**
데이터 캡슐화 : 인스턴스를 private 를 통해 외부에서 접근을 막아라 - 데이터 캡슐화<br>
메서드 캡슐화 : protected 를 통해 클래스 내부와 서브 클래스에서만 접근 가능하다 - 클래스 내부 행동을 캡슐화해라<br>
객체 캡슐화 : 클래스는 추상화 인스턴스가 포함된다 - 합성<br>
서브타입 캡슐화 : 구체 클래스를 알지 못하고 추상화에만 의존한다 - 다형성<br>
<br>
변하는 부분을 분리해서 타입 계층을 만든다.<br>
변하지 않는 부분의 일부로 타입 계층을 합성한다.<br>

## 3. 일관성 있는 기본 정책 구현하기
- 변하지 않는 부분으로부터 변하는 부분을 분리하라
- 변하는 부분의 공통점을 추상화하는 것도 잊지마라
- 변하지 않는 부분이 오직 이 추상화에만 의존하도록 변경을 캡슐화해라<br>

<br>
그림1
<br>
변하는 부분은 구체 클래스로 객체 캡슐화를 하라<br>
FeeRule 이 FeeCondition 을 합성 관계로 연결하고 있다는 점에도 주목하자.<br>
도메인 적성후 추상화들간의 협력 패턴을 만들자<br>
그림2
<br>

코드를 통해 자세히 확인해보자