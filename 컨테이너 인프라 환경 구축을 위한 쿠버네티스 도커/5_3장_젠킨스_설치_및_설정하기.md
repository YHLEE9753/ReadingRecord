# 5.3장 젠킨스 설치 및 설정하기

## 스터디 날짜
2022/03/24

## 5.3.1 헬름으로 젠킨스 설치하기

```
[root@m-k8s 4.3.4]# ~/_Book_k8sInfra/ch5/5.3.1/nfs-exporter.sh jenkins
Created symlink from /etc/systemd/system/multi-user.target.wants/nfs-server.service to /usr/lib/systemd/system/nfs-server.service.
[root@m-k8s 4.3.4]# ls -n /nfs_shared
total 0
drwxr-xr-x. 2 0 0 6 Mar 19 02:14 jenkins

[root@m-k8s 4.3.4]# chown 1000:1000 /nfs_shared/jenkins/
[root@m-k8s 4.3.4]# ls -n /nfs_shared
total 0
drwxr-xr-x. 2 1000 1000 6 Mar 19 02:14 jenkins

[root@m-k8s 4.3.4]# kubectl apply -f ~/_Book_k8sInfra/ch5/5.3.1/jenkins-volume.yaml
persistentvolume/jenkins created
persistentvolumeclaim/jenkins created
[root@m-k8s 4.3.4]# kubectl get pv jenkins
NAME      CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM             STORAGECLASS   REASON   AGE
jenkins   10Gi       RWX            Retain           Bound    default/jenkins                           8s
[root@m-k8s 4.3.4]# kubectl get pvc jenkins
NAME      STATUS   VOLUME    CAPACITY   ACCESS MODES   STORAGECLASS   AGE
jenkins   Bound    jenkins   10Gi       RWX                           18s


[root@m-k8s 4.3.4]# ~/_Book_k8sInfra/ch5/5.3.1/jenkins-install.sh
NAME: jenkins
LAST DEPLOYED: Sat Mar 19 02:19:21 2022
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get your 'admin' user password by running:
  printf $(kubectl get secret --namespace default jenkins -o jsonpath="{.data.jenkins-admin-password}" | base64 --decode);echo
2. Get the Jenkins URL to visit by running these commands in the same shell:
  NOTE: It may take a few minutes for the LoadBalancer IP to be available.
        You can watch the status of by running 'kubectl get svc --namespace default -w jenkins'
  export SERVICE_IP=$(kubectl get svc --namespace default jenkins --template "{{ range (index .status.loadBalancer.ingress 0) }}{{ . }}{{ end }}")
  echo http://$SERVICE_IP:80/login

3. Login with the password from step 1 and the username: admin

4. Use Jenkins Configuration as Code by specifying configScripts in your values.yaml file, see documentation: http:///configuration-as-code and examples: https://github.com/jenkinsci/configuration-as-code-plugin/tree/master/demos

For more information on running Jenkins on Kubernetes, visit:
https://cloud.google.com/solutions/jenkins-on-container-engine
For more information about Jenkins Configuration as Code, visit:
https://jenkins.io/projects/jcasc/


[root@m-k8s 4.3.4]# kubectl get deployment
NAME      READY   UP-TO-DATE   AVAILABLE   AGE
jenkins   0/1     1            0           48s

[root@m-k8s 4.3.4]# kubectl get service jenkins
NAME      TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)        AGE
jenkins   LoadBalancer   10.97.189.204   192.168.1.11   80:32246/TCP   70s
[root@m-k8s 4.3.4]# kubectl get pod -o wide
NAME                       READY   STATUS     RESTARTS   AGE   IP       NODE    NOMINATED NODE   READINESS GATES
jenkins-6b6f9b8675-5ktds   0/2     Init:0/1   0          75s   <none>   m-k8s   <none>           <none>

```
